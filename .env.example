# =============================================================================
# n8n-compose Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# IMPORTANT: Never commit the .env file - it contains secrets!
# =============================================================================

# -----------------------------------------------------------------------------
# Domain Configuration
# -----------------------------------------------------------------------------
# DOMAIN_NAME and SUBDOMAIN together determine where n8n will be reachable
# Example: n8n.example.com

# The top level domain to serve from
DOMAIN_NAME=example.com

# The subdomain to serve from
SUBDOMAIN=n8n

# -----------------------------------------------------------------------------
# Cloudflare Tunnel
# -----------------------------------------------------------------------------
# Your Cloudflare Tunnel token from Zero Trust dashboard
# See CLOUDFLARE_SETUP.md for instructions on obtaining this token
# Get it from: https://one.dash.cloudflare.com/ > Networks > Tunnels
CLOUDFLARE_TUNNEL_TOKEN=your-tunnel-token-here

# -----------------------------------------------------------------------------
# Timezone
# -----------------------------------------------------------------------------
# Timezone for scheduled workflows (IANA format)
# See: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
GENERIC_TIMEZONE=America/Chicago

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
# Root user credentials (used for initial database setup and backups)
# IMPORTANT: Generate strong, unique passwords! Use: openssl rand -base64 32
POSTGRES_USER=n8n_owner
POSTGRES_PASSWORD=CHANGE_ME_generate_strong_password
POSTGRES_DB=n8n

# Non-root user credentials (used by n8n application)
# Created automatically by init-data.sh on first run
# IMPORTANT: Generate a different strong password here!
POSTGRES_NON_ROOT_USER=n8n_user
POSTGRES_NON_ROOT_PASSWORD=CHANGE_ME_generate_another_password

# -----------------------------------------------------------------------------
# n8n Encryption Key (IMPORTANT!)
# -----------------------------------------------------------------------------
# n8n uses this key to encrypt credentials stored in the database (API keys,
# OAuth tokens, passwords, etc.).
#
# CRITICAL:
#   - Generate a unique 32+ character key and NEVER change it after first run
#   - Back up this key securely - without it, stored credentials are unrecoverable
#   - If migrating/restoring, you MUST use the same key as the original installation
#
# Generate with: openssl rand -hex 32
N8N_ENCRYPTION_KEY=CHANGE_ME_generate_hex_key

# -----------------------------------------------------------------------------
# n8n Security Settings
# -----------------------------------------------------------------------------
# Required for HTTPS - ensures cookies are only sent over secure connections
N8N_SECURE_COOKIE=true

# Number of reverse proxies in front of n8n (Cloudflare Tunnel = 1)
# Required for correct client IP detection and rate limiting
N8N_PROXY_HOPS=1

# Log level: error, warn, info, debug (use warn or error in production)
N8N_LOG_LEVEL=warn

# -----------------------------------------------------------------------------
# n8n Execution Settings
# -----------------------------------------------------------------------------
# Auto-prune old execution history to prevent database bloat
EXECUTIONS_DATA_PRUNE=true

# Hours to keep execution history (336 = 14 days)
EXECUTIONS_DATA_MAX_AGE=336

# Default timeout for workflow execution in seconds (300 = 5 minutes)
EXECUTIONS_TIMEOUT=300

# Maximum timeout users can configure for workflows (3600 = 1 hour)
EXECUTIONS_TIMEOUT_MAX=3600

# Maximum request payload size in MB
N8N_PAYLOAD_SIZE_MAX=16

# -----------------------------------------------------------------------------
# n8n Telemetry Settings
# -----------------------------------------------------------------------------
# Disable anonymous usage statistics
N8N_DIAGNOSTICS_ENABLED=false

# Disable version update notifications (you have update.sh for this)
N8N_VERSION_NOTIFICATIONS_ENABLED=false

# -----------------------------------------------------------------------------
# Backup Configuration (Optional)
# -----------------------------------------------------------------------------
# If set, backups will be encrypted with AES-256-CBC using this passphrase
# IMPORTANT: Store this key securely - you cannot restore encrypted backups without it!
# Generate with: openssl rand -base64 32
# BACKUP_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# Secret Generation Helper
# -----------------------------------------------------------------------------
# Generate all required secrets at once with:
#
#   echo "POSTGRES_PASSWORD=$(openssl rand -base64 32)"
#   echo "POSTGRES_NON_ROOT_PASSWORD=$(openssl rand -base64 32)"
#   echo "N8N_ENCRYPTION_KEY=$(openssl rand -hex 32)"
#   echo "BACKUP_ENCRYPTION_KEY=$(openssl rand -base64 32)"
#
# =============================================================================
